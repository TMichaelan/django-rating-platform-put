{% extends "header.html" %}
{% load userview_extras %}
{% load crispy_forms_tags %}
{% block content %}

{% comment %} {% extends "base.html" %} {% endcomment %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">



<h1>{{ movie.title }}</h1>

<h4>Movie id: {{ movie.id }}</h4>

<h4>Movie IMDB audience_rating: {{ movie.imdbrating.audience_rating }}</h4>
<h4>Movie IMDB critic_rating: {{ movie.imdbrating.critic_rating }}</h4>
<h4>Movie Platform user average rating: {{ average_rating }}</h4>
<h4>Movie IMDB link: <a href="https://www.imdb.com/title/{{movie.imdb_url}}">IMDB LINK</a></h4>
<h4>Movie year: {{ movie.year }}</h4>
<img src="{{ movie.img_url }}">

<ul>
    <p> Comments: {% for genre in movie.genres.all %} </p>
    <li><a
           class="list-group-item list-group-item-action"
           href="/genre/{{genre.id}}"
           >{{ genre.name }}</a></li>
     {% endfor %}
 </ul>


<ul>
   <p> Genres: {% for genre in movie.genres.all %} </p>
   <li><a
          class="list-group-item list-group-item-action"
          href="/genre/{{genre.id}}"
          >{{ genre.name }}</a></li>
    {% endfor %}
</ul>


{% if page_obj %}

{% for movie in page_obj %}
<h4>
    <a class="list-group-item list-group-item-action" href="/movie/{{movie.id}}">{{ movie.title }}</a>
</h4>
{% endfor %} 
{% endif %} 

{% if user.is_authenticated %}

<h3>Rate this movie</h3>
    <form method="post">
        {% csrf_token %}
        {{ form|crispy }}
        <button class="btn btn-success" type="submit">Add Rating</button>
    </form>

{% comment %} <div class="container py-5">
    <h3>Add a Rating</h3>
    <form method="post">
        {% csrf_token %}
        {{ form|crispy }}
        <button class="btn btn-success" type="submit">Add Rating</button>
        <a name="" id="" class="btn btn-primary" href="/" role="button">Home</a>
    </form>
</div> {% endcomment %}

{% comment %} 
<form method="POST" action="/comment/{{ movie.id }}/rate">
    {% csrf_token %}
    {{ form|crispy }}
    Rate movie {{ movie.title }}:
    <div class="input-group">
        <textarea class="form-control" aria-label="With textarea"></textarea>
      </div>
    <button type="submit" class="btn btn-primary">Rate</button>
</form> {% endcomment %}


{% comment %} <form method="POST" action="/comment/{{ movie.id }}/rate">
    {% csrf_token %}
    {{ form|crispy }}
    Leave comment:
    <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
    <button type="submit" class="btn btn-primary">Comment</button>
</form> {% endcomment %}
{% endif %} 

{% endblock %}